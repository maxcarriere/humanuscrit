{% comment %}
  Navigation dans un dossier : Texte précédent / suivant / Retour au sommaire
  Affichée pour les pages dans un sous-dossier de textes/ ou productions/
{% endcomment %}
{% assign path = page.path %}
{% assign is_texte = false %}
{% assign is_production = false %}
{% if path contains "textes/" and path != "textes/index.md" %}
  {% assign is_texte = true %}
{% endif %}
{% if path contains "productions/" and path != "productions/index.md" %}
  {% assign is_production = true %}
{% endif %}
{% if is_texte or is_production %}
  {% comment %} Extraire le dossier courant (ex: textes/0-presciptum) {% endcomment %}
  {% assign parts = path | split: "/" %}
  {% assign dir = "" %}
  {% for part in parts %}
    {% if forloop.last %}{% break %}{% endif %}
    {% if dir != "" %}{% assign dir = dir | append: "/" %}{% endif %}
    {% assign dir = dir | append: part %}
  {% endfor %}

  {% comment %} Trouver les pages du même dossier, triées, et calculer prev/next {% endcomment %}
  {% assign prev_page = "" %}
  {% assign next_page = "" %}
  {% assign found_current = false %}
  {% assign sorted = site.pages | sort: "path" %}
  {% for p in sorted %}
    {% if p.path contains "textes/" or p.path contains "productions/" %}
    {% if p.name != "index.md" and p.name != "README.md" %}
      {% assign p_parts = p.path | split: "/" %}
      {% assign p_dir = "" %}
      {% for part in p_parts %}
        {% if forloop.last %}{% break %}{% endif %}
        {% if p_dir != "" %}{% assign p_dir = p_dir | append: "/" %}{% endif %}
        {% assign p_dir = p_dir | append: part %}
      {% endfor %}
      {% if p_dir == dir %}
        {% if p.url == page.url %}
          {% assign found_current = true %}
        {% elsif found_current %}
          {% assign next_page = p %}
          {% break %}
        {% else %}
          {% assign prev_page = p %}
        {% endif %}
      {% endif %}
    {% endif %}
    {% endif %}
  {% endfor %}

  <nav class="navigation-dossier" aria-label="Navigation dans le dossier">
    <p>
      {% if prev_page != "" %}
        <a href="{{ prev_page.url | relative_url }}">← Texte précédent</a> ·
      {% endif %}
      {% if next_page != "" %}
        <a href="{{ next_page.url | relative_url }}">Texte suivant →</a> ·
      {% endif %}
      {% if is_texte %}
      <a href="{{ '/textes/' | relative_url }}">Retour au sommaire</a>
      {% else %}
      <a href="{{ '/productions/' | relative_url }}">Retour au sommaire</a>
      {% endif %}
    </p>
  </nav>
{% endif %}
